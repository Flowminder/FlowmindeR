<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphs and Data cookbook for R • FlowmindeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Graphs and Data cookbook for R">
<meta property="og:description" content="FlowmindeR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FlowmindeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/graphics.html">Graphs and Data cookbook for R</a>
    </li>
    <li>
      <a href="../articles/maps.html">Maps</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="graphics_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Graphs and Data cookbook for R</h1>
            
      
      
      <div class="hidden name"><code>graphics.Rmd</code></div>

    </div>

    
    
<div id="about" class="section level1">
<h1 class="hasAnchor">
<a href="#about" class="anchor"></a>About</h1>
<p>This document along with the <strong>FlowmindeR</strong> package is designed to help simplify the creation of consistent, publication-ready graphics. This is built around the <strong>ggplot2</strong> R library. This document is shamelessly adpated from the <a href="https://bbc.github.io/rcookbook/">BBC style guide</a>.</p>
<p>This acts as a brief tutorial to some of the most common types of graphs we may want to produce. If you are completely new to R or ggplot and wanting some good background reading, I would recommend reviewing:</p>
<ul>
<li>
<a href="https://r4ds.had.co.nz/">R for Data Science</a>: comprehensive book explaining the data workflow in R. <a href="https://r4ds.had.co.nz/data-visualisation.html">Chapter 3</a> covers the use of ggplot</li>
<li>
<a href="https://ggplot2-book.org/">ggplot2: Elegant Graphics for Data Analysis</a>: book in development</li>
</ul>
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h1>
<p>A few of the steps in this vignette - and to create charts in R in general - require certain packages to be installed and loaded. We will use the <strong>FlowmindeR</strong> package alongside <strong>tidyverse</strong> and <strong>gapminder</strong> (used as example data). If this is your first time using the package, you can install it via GitHub at:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"Flowminder/FlowmindeR"</span>, <span class="kw">force</span> <span class="kw">=</span> <span class="no">T</span>)</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">FlowmindeR</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)</pre></body></html></div>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.0     ✓ purrr   0.3.4
## ✓ tibble  3.0.1     ✓ dplyr   0.8.5
## ✓ tidyr   1.0.2     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gapminder</span>)</pre></body></html></div>
<div id="how-does-the-flowminder-package-work" class="section level2">
<h2 class="hasAnchor">
<a href="#how-does-the-flowminder-package-work" class="anchor"></a>How does the FlowmindeR package work?</h2>
<p>The package has two functions, <code><a href="../reference/set_fm_style.html">set_fm_style()</a></code> and <code><a href="../reference/finalise_plot.html">finalise_plot()</a></code>.</p>
<p><code><a href="../reference/set_fm_style.html">set_fm_style()</a></code>: has no arguments and used to set the default ggplot themes. What it does is generally makes text size, font and colour, axis lines, axis text and many other standard chart components into the Flowminder style. The function is pretty basic and does not change or adapt based on the type of chart you are making, so in some cases you will need to make additional <code>theme</code> arguments in your ggplot chain if you want to make any additions or changes to the style, for example to add or remove gridlines etc. You will only need to set the theme once at the start of your script:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="kw pkg">FlowmindeR</span><span class="kw ns">::</span><span class="fu"><a href="../reference/set_fm_style.html">set_fm_style</a></span>()</pre></body></html></div>
</div>
<div id="a-basic-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#a-basic-chart" class="anchor"></a>A basic chart</h2>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># Data for chart from gapminder package</span>
<span class="no">line_df</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">country</span> <span class="kw">==</span> <span class="st">"Malawi"</span>)

<span class="co"># Make plot</span>
<span class="no">line</span> <span class="kw">&lt;-</span>
  <span class="fu">ggplot</span>(<span class="no">line_df</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">year</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">lifeExp</span>)) +
  <span class="fu">geom_line</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"Living longer"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Life expectancy in Malawi 1952-2007"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Life Expectancy"</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Year"</span>)

<span class="no">line</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>You can modify these settings for your chart, or add additional theme arguments, by calling the <code>theme</code> function with the arguments you want. There are many similar examples throughout the cookbook.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">line</span> +
  <span class="fu">theme</span>(<span class="kw">panel.grid.major.x</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"#cbcbcb"</span>),
        <span class="kw">panel.grid.major.y</span><span class="kw">=</span><span class="fu">element_blank</span>())</pre></body></html></div>
<div id="save-out-your-finished-chart" class="section level3">
<h3 class="hasAnchor">
<a href="#save-out-your-finished-chart" class="anchor"></a>Save out your finished chart</h3>
<p><code><a href="../reference/finalise_plot.html">finalise_plot()</a></code>, the second function of the <code>FlowmindeR</code> package, will left-align the title, subtitle and add the footer with a source and an image in the bottom right corner of your plot. It will also save it to your specified location. The function has five arguments:</p>
<p>Here are the function arguments: <code><a href="../reference/finalise_plot.html">finalise_plot(plot_name, source, save_filepath, width_pixels = 640, height_pixels = 450)</a></code></p>
<ul>
<li>
<code>plot_name</code>: the variable name that you have called your plot, for example for the chart example above <code>plot_name</code> would be <code>"line"</code><br>
</li>
<li>
<code>source</code>: the source text that you want to appear at the bottom left corner of your plot. You will need to type the word <code>"Source:"</code> before it, so for example <code>source = "Source: ONS"</code> would be the right way to do that.</li>
<li>
<code>save_filepath</code>: the precise filepath that you want your graphic to save to, including the <code>.png</code> extension at the end. This does depend on your working directory and if you are in a specific R project. An example filepath would be: <code>Desktop/R_projects/charts/line_chart.png</code>.</li>
<li>
<code>width_pixels</code>: this is set to 640px by default, so only call this argument if you want the chart to have a different width, and specify what you want it to be.</li>
<li>
<code>height_pixels</code>: this is set to 450px by default, so only call this argument if you want the chart to have a different height, and specify what you want it to be.</li>
<li>
<code>logo_image_path</code>: this argument specifies the path for the image/logo in the bottom right corner of the plot. The default is for a placeholder PNG file with a background that matches the background colour of the plot, so do not specify the argument if you want it to appear without a logo. If you want to add your own logo, just specify the path to your PNG file. The package has been prepared with a wide and thin image in mind.</li>
</ul>
<p>Example of how the <code><a href="../reference/finalise_plot.html">finalise_plot()</a></code> is used in a standard workflow. This function is called once you have created and finalised your chart data:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/finalise_plot.html">finalise_plot</a></span>(<span class="kw">plot_name</span> <span class="kw">=</span> <span class="no">line</span>,
              <span class="kw">source</span> <span class="kw">=</span> <span class="st">"Source: Gapminder"</span>,
              <span class="kw">save_filepath</span> <span class="kw">=</span> <span class="st">"filename_that_my_plot_should_be_saved_to.png"</span>,
              <span class="kw">width_pixels</span> <span class="kw">=</span> <span class="fl">640</span>,
              <span class="kw">height_pixels</span> <span class="kw">=</span> <span class="fl">450</span>)</pre></body></html></div>
<p>So once you have created your plot and are relatively happy with it, you can use the <code><a href="../reference/finalise_plot.html">finalise_plot()</a></code> function to make the final adjustments and save out your chart so that you can look at it outside RStudio.</p>
<p>It is important to mention that it is a good idea to do this early on because the position of the text and other elements do not render accurately in the RStudio Plots panel because this depends on the size and aspect ratio you want your plot to appear, so saving it out and opening up the files give you an accurate representation of how the graphic looks.</p>
<p>The <code><a href="../reference/finalise_plot.html">finalise_plot()</a></code> function does more than just save out your chart, it also left-aligns the title and subtitle as is standard for BBC graphics, adds a footer with the logo on the right side and lets you input source text on the left side.</p>
<p>So how can you save out the example plot created above?</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/finalise_plot.html">finalise_plot</a></span>(<span class="kw">plot_name</span> <span class="kw">=</span> <span class="no">line</span>,
              <span class="kw">source</span> <span class="kw">=</span> <span class="st">"Source: Gapminder"</span>,
              <span class="kw">save_filepath</span> <span class="kw">=</span> <span class="st">"images/line_plot_finalised_test.png"</span>,
              <span class="kw">width_pixels</span> <span class="kw">=</span> <span class="fl">640</span>,
              <span class="kw">height_pixels</span> <span class="kw">=</span> <span class="fl">550</span>)</pre></body></html></div>
</div>
</div>
</div>
<div id="types-of-charts" class="section level1">
<h1 class="hasAnchor">
<a href="#types-of-charts" class="anchor"></a>Types of Charts</h1>
<div id="make-a-line-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#make-a-line-chart" class="anchor"></a>Make a line chart</h2>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># Prepare data</span>
<span class="no">line_df</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">country</span> <span class="kw">==</span> <span class="st">"China"</span>)

<span class="co"># Make plot</span>
<span class="no">line</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">line_df</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">year</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">lifeExp</span>)) +
  <span class="fu">geom_line</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"Living longer"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Life expectancy in China 1952-2007"</span>)

<span class="no">line</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="make-a-multiple-line-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#make-a-multiple-line-chart" class="anchor"></a>Make a multiple line chart</h2>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># Prepare data</span>
<span class="no">multiple_line_df</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">country</span> <span class="kw">==</span> <span class="st">"China"</span> <span class="kw">|</span> <span class="no">country</span> <span class="kw">==</span> <span class="st">"United States"</span>)

<span class="co"># Make plot</span>
<span class="no">multiple_line</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">multiple_line_df</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">year</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">lifeExp</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="no">country</span>)) +
  <span class="fu">geom_line</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"Living longer"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Life expectancy in China and the US"</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Year"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Life Expectancy"</span>)

<span class="no">multiple_line</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="make-a-bar-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#make-a-bar-chart" class="anchor"></a>Make a bar chart</h2>
<p><strong>ggplot</strong> will normally add a space between the plot and the axis. This is normally fine, but with barplots especially it is recommended to remove this gap. This can be done with <code>scale_y_continuous(expand = expand_scale(mult = c(0, .1)))</code>:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># Prepare data</span>
<span class="no">bar_df</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">year</span> <span class="kw">==</span> <span class="fl">2007</span> <span class="kw">&amp;</span> <span class="no">continent</span> <span class="kw">==</span> <span class="st">"Africa"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="no">lifeExp</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">5</span>)

<span class="co"># Make plot</span>
<span class="no">bars</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">bar_df</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">country</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">lifeExp</span>)) +
  <span class="fu">geom_bar</span>(<span class="kw">stat</span><span class="kw">=</span><span class="st">"identity"</span>,
           <span class="kw">position</span><span class="kw">=</span><span class="st">"identity"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"Reunion is highest"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Highest African life expectancy, 2007"</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Country"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Life Expectancy"</span>) +
  <span class="fu">scale_y_continuous</span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu">expand_scale</span>(<span class="kw">mult</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.1</span>)))</pre></body></html></div>
<pre><code>## Warning: `expand_scale()` is deprecated; use `expansion()` instead.</code></pre>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">bars</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-10-1.png" width="700"> ## Make a stacked bar chart</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># Prepare data</span>
<span class="no">stacked_df</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">year</span> <span class="kw">==</span> <span class="fl">2007</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">lifeExpGrouped</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="no">lifeExp</span>,
                              <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">65</span>, <span class="fl">80</span>, <span class="fl">90</span>),
                              <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Under 50"</span>, <span class="st">"50-65"</span>, <span class="st">"65-80"</span>, <span class="st">"80+"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">continent</span>, <span class="no">lifeExpGrouped</span>) <span class="kw">%&gt;%</span>
  <span class="fu">summarise</span>(<span class="kw">continentPop</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">pop</span>)))

<span class="co"># set order of stacks by changing factor levels</span>
<span class="no">stacked_df</span>$<span class="no">lifeExpGrouped</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">stacked_df</span>$<span class="no">lifeExpGrouped</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">stacked_df</span>$<span class="no">lifeExpGrouped</span>)))

<span class="co"># create plot</span>
<span class="no">stacked_bars</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">stacked_df</span>,
                       <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">continent</span>,
                           <span class="kw">y</span> <span class="kw">=</span> <span class="no">continentPop</span>,
                           <span class="kw">fill</span> <span class="kw">=</span> <span class="no">lifeExpGrouped</span>)) +
  <span class="fu">geom_bar</span>(<span class="kw">stat</span> <span class="kw">=</span> <span class="st">"identity"</span>,
           <span class="kw">position</span> <span class="kw">=</span> <span class="st">"fill"</span>) +
  <span class="fu">scale_y_continuous</span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="no"><a href="https://scales.r-lib.org//reference/label_percent.html">percent</a></span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"How life expectancy varies"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"% of population by life expectancy band, 2007"</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Continent"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Proportion"</span>,
       <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"Life Expectancy Grouped"</span>)  +
  <span class="fu">scale_y_continuous</span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu">expand_scale</span>(<span class="kw">mult</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.1</span>)))</pre></body></html></div>
<pre><code>## Warning: `expand_scale()` is deprecated; use `expansion()` instead.</code></pre>
<pre><code>## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.</code></pre>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">stacked_bars</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>This example shows proportions, but you might want to make a stacked bar chart showing number values instead - this is easy to change! The value passed to the <code>position</code> argument will determine if your stacked chart shows proportions or actual values. <code>position = "fill"</code> will draw your stacks as proportions, and <code>position = "identity"</code> will draw number values.</p>
</div>
<div id="make-a-grouped-bar-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#make-a-grouped-bar-chart" class="anchor"></a>Make a grouped bar chart</h2>
<p>Making a grouped bar chart is very similar to making a bar chart. You just need to change <code>position = "identity"</code> to <code>position = "dodge"</code>, and set the <code>fill</code> aesthetically instead:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># Prepare data</span>
<span class="no">grouped_bar_df</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">year</span> <span class="kw">==</span> <span class="fl">1967</span> <span class="kw">|</span> <span class="no">year</span> <span class="kw">==</span> <span class="fl">2007</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">country</span>, <span class="no">year</span>, <span class="no">lifeExp</span>) <span class="kw">%&gt;%</span>
  <span class="fu">spread</span>(<span class="no">year</span>, <span class="no">lifeExp</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">gap</span> <span class="kw">=</span> <span class="no">`2007`</span> - <span class="no">`1967`</span>) <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="no">gap</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">5</span>) <span class="kw">%&gt;%</span>
  <span class="fu">gather</span>(<span class="kw">key</span> <span class="kw">=</span> <span class="no">year</span>,
         <span class="kw">value</span> <span class="kw">=</span> <span class="no">lifeExp</span>,
         -<span class="no">country</span>,
         -<span class="no">gap</span>)

<span class="co"># Make plot</span>
<span class="no">grouped_bars</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">grouped_bar_df</span>,
                       <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">country</span>,
                           <span class="kw">y</span> <span class="kw">=</span> <span class="no">lifeExp</span>,
                           <span class="kw">fill</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">year</span>))) +
  <span class="fu">geom_bar</span>(<span class="kw">stat</span><span class="kw">=</span><span class="st">"identity"</span>, <span class="kw">position</span><span class="kw">=</span><span class="st">"dodge"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"We're living longer"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Biggest life expectancy rise, 1967-2007"</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Country"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Life Expectancy"</span>,
       <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"Year"</span>) +
  <span class="fu">scale_y_continuous</span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu">expand_scale</span>(<span class="kw">mult</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.1</span>)))</pre></body></html></div>
<pre><code>## Warning: `expand_scale()` is deprecated; use `expansion()` instead.</code></pre>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">grouped_bars</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-12-1.png" width="700"> ## Make a dumbbell chart</p>
<p>Another way of showing difference is a dumbbell chart:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggalt</span>)</pre></body></html></div>
<pre><code>## Registered S3 methods overwritten by 'ggalt':
##   method                  from   
##   grid.draw.absoluteGrob  ggplot2
##   grobHeight.absoluteGrob ggplot2
##   grobWidth.absoluteGrob  ggplot2
##   grobX.absoluteGrob      ggplot2
##   grobY.absoluteGrob      ggplot2</code></pre>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="co"># Prepare data</span>
<span class="no">dumbbell_df</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">year</span> <span class="kw">==</span> <span class="fl">1967</span> <span class="kw">|</span> <span class="no">year</span> <span class="kw">==</span> <span class="fl">2007</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">country</span>, <span class="no">year</span>, <span class="no">lifeExp</span>) <span class="kw">%&gt;%</span>
  <span class="fu">spread</span>(<span class="no">year</span>, <span class="no">lifeExp</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">gap</span> <span class="kw">=</span> <span class="no">`2007`</span> - <span class="no">`1967`</span>) <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="no">gap</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">10</span>)

<span class="co"># Make plot</span>
<span class="fu">ggplot</span>(<span class="no">dumbbell_df</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">`1967`</span>, <span class="kw">xend</span> <span class="kw">=</span> <span class="no">`2007`</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">country</span>, <span class="no">gap</span>), <span class="kw">group</span> <span class="kw">=</span> <span class="no">country</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggalt/man/geom_dumbbell.html">geom_dumbbell</a></span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#dddddd"</span>,
                <span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>,
                <span class="kw">colour_x</span> <span class="kw">=</span> <span class="st">"#FAAB18"</span>,
                <span class="kw">colour_xend</span> <span class="kw">=</span> <span class="st">"#1380A1"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"We're living longer"</span>,
       <span class="kw">subtitle</span><span class="kw">=</span><span class="st">"Biggest life expectancy rise, 1967-2007"</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Age"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Country"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="make-a-histogram" class="section level2">
<h2 class="hasAnchor">
<a href="#make-a-histogram" class="anchor"></a>Make a histogram</h2>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">hist_df</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">year</span> <span class="kw">==</span> <span class="fl">2007</span>)

<span class="fu">ggplot</span>(<span class="no">hist_df</span>, <span class="fu">aes</span>(<span class="no">lifeExp</span>)) +
  <span class="fu">geom_histogram</span>(<span class="kw">binwidth</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"white"</span>) +
  <span class="fu">scale_x_continuous</span>(<span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">35</span>, <span class="fl">95</span>),
                     <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">40</span>, <span class="fl">90</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">10</span>),
                     <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"40"</span>, <span class="st">"50"</span>, <span class="st">"60"</span>, <span class="st">"70"</span>, <span class="st">"80"</span>, <span class="st">"90 years"</span>)) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"How life expectancy varies"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Distribution of life expectancy in 2007"</span>) +
  <span class="fu">scale_y_continuous</span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu">expand_scale</span>(<span class="kw">mult</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.1</span>)))</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
<div id="tweaking-graphs" class="section level1">
<h1 class="hasAnchor">
<a href="#tweaking-graphs" class="anchor"></a>Tweaking Graphs</h1>
<div id="remove-the-legend" class="section level2">
<h2 class="hasAnchor">
<a href="#remove-the-legend" class="anchor"></a>Remove the legend</h2>
<p>Remove the legend to become one - it’s better to label data directly with text annotations.</p>
<p>Use <code>guides(colour=FALSE)</code> to remove the legend for a specific aesthetic (replace <code>colour</code> with the relevant aesthetic).</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">guides</span>(<span class="kw">colour</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<p>You can also remove all legends in one go using <code>theme(legend.position = "none")</code>:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="change-the-position-of-the-legend" class="section level2">
<h2 class="hasAnchor">
<a href="#change-the-position-of-the-legend" class="anchor"></a>Change the position of the legend</h2>
<p>The legend’s default position is at the right of your plot. Move it to the left, right or bottom outside the plot with:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"top"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>To be really precise about where we want our legend to go, instead of specifying “right” or “top” to change the general position of where the legend appears in our chart, we can give it specific coordinates.</p>
<p>For example <code>legend.position=c(0.98,0.1)</code> will move the legend to the bottom right. For reference, c(0,0) is bottom left, c(1,0) is bottom right, c(0,1) is top left and so on). Finding the exact position may involve some trial and error.</p>
<p>To check the exact position where the legend appears in your finalised plot you will have to check the file that is saved out after you run your <code><a href="../reference/finalise_plot.html">finalise_plot()</a></code> function, as the position will be relevant to the dimensions of the plot.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.115</span>,<span class="fl">1.05</span>),
                      <span class="kw">legend.direction</span> <span class="kw">=</span> <span class="st">"horizontal"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"Living longer"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Life expectancy in China and the US\n"</span>)</pre></body></html></div>
<p>To get the legend flush against the left side of your chart, it may be easier to set a negative left margin for the legend using <code>legend.margin</code>. The syntax is <code>margin(top, right, bottom, left)</code>.</p>
<p>You’ll have to experiment to find the correct number to set the margin to for your chart - save it out with <code><a href="../reference/finalise_plot.html">finalise_plot()</a></code> and see how it looks.</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r">+ <span class="fu">theme</span>(<span class="kw">legend.margin</span> <span class="kw">=</span> <span class="fu">margin</span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, -<span class="fl">200</span>))</pre></body></html></div>
</div>
<div id="remove-the-legend-title" class="section level2">
<h2 class="hasAnchor">
<a href="#remove-the-legend-title" class="anchor"></a>Remove the legend title</h2>
<p>Remove the legend title by tweaking your <code>theme()</code>:</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r">+ <span class="fu">theme</span>(<span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu">element_blank</span>())</pre></body></html></div>
</div>
<div id="reverse-the-order-of-your-legend" class="section level2">
<h2 class="hasAnchor">
<a href="#reverse-the-order-of-your-legend" class="anchor"></a>Reverse the order of your legend</h2>
<p>Sometimes you need to change the order of your legend for it to match the order of your bars. For this, you need <code>guides</code>:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r">+ <span class="fu">guides</span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="fu">guide_legend</span>(<span class="kw">reverse</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
</div>
<div id="rearrange-the-layout-of-your-legend" class="section level2">
<h2 class="hasAnchor">
<a href="#rearrange-the-layout-of-your-legend" class="anchor"></a>Rearrange the layout of your legend</h2>
<p>If you’ve got many values in your legend, you may need to rearrange the layout for aesthetic reasons.</p>
<p>You can specify the number of rows you want your legend to have as an argument to <code>guides</code>. The below code snippet, for instance, will create a legend with 4 rows:</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r">+ <span class="fu">guides</span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="fu">guide_legend</span>(<span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="no">T</span>))</pre></body></html></div>
<p>You may need to change <code>fill</code> in the code above to whatever aesthetic your legend is describing, e.g. <code>size</code>, <code>colour</code>, etc.</p>
</div>
<div id="change-the-appearance-of-your-legend-symbols" class="section level2">
<h2 class="hasAnchor">
<a href="#change-the-appearance-of-your-legend-symbols" class="anchor"></a>Change the appearance of your legend symbols</h2>
<p>You can override the default appearance of the legend symbols, without changing the way they appear in the plot, by adding the argument <code>override.aes</code> to <code>guides</code>.</p>
<p>The below will make the size of the legend symbols larger, for instance:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r">+ guides(fill = guide_legend(override.aes = list(size = 4))))</pre></body></html></div>
</div>
<div id="add-space-between-your-legend-labels" class="section level2">
<h2 class="hasAnchor">
<a href="#add-space-between-your-legend-labels" class="anchor"></a>Add space between your legend labels</h2>
<p>The default ggplot legend has almost no space between individual legend items. Not ideal.</p>
<p>You can add space by changing the scale labels manually.</p>
<p>For instance, if you have set the colour of your geoms to be dependent on your data, you will get a legend for the colour, and you can tweak the exact labels to get some extra space in by using the below snippet:</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r">+ <span class="fu">scale_colour_manual</span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">" "</span>, <span class="no">x</span>, <span class="st">"  "</span>))</pre></body></html></div>
<p>If your legend is showing something different, you will need to change the code accordingly. For instance, for fill, you will need <code>scale_fill_manual()</code> instead.</p>
</div>
</div>
<div id="make-changes-to-the-axes" class="section level1">
<h1 class="hasAnchor">
<a href="#make-changes-to-the-axes" class="anchor"></a>Make changes to the axes</h1>
<div id="flip-the-coordinates-of-a-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#flip-the-coordinates-of-a-plot" class="anchor"></a>Flip the coordinates of a plot</h2>
<p>Add <code>coord_flip()</code> to make your vertical bars horizontal:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">bars</span> <span class="kw">&lt;-</span> <span class="no">bars</span> +
  <span class="fu">coord_flip</span>() +
  <span class="fu">scale_y_continuous</span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu">expand_scale</span>(<span class="kw">mult</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.1</span>))) +
  <span class="fu">scale_x_discrete</span>()</pre></body></html></div>
<pre><code>## Warning: `expand_scale()` is deprecated; use `expansion()` instead.</code></pre>
<pre><code>## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.</code></pre>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="no">bars</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div id="addremove-gridlines" class="section level2">
<h2 class="hasAnchor">
<a href="#addremove-gridlines" class="anchor"></a>Add/remove gridlines</h2>
<p>The default theme only has gridlines for the y axis. Add x gridlines with <code>panel.grid.major.x = element_line</code>.</p>
<p>(Similarly, remove the gridlines on the y axis with <code>panel.grid.major.y=element_blank()</code>)</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">bars</span> <span class="kw">&lt;-</span> <span class="no">bars</span> + <span class="fu">coord_flip</span>() +
  <span class="fu">theme</span>(<span class="kw">panel.grid.major.x</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"#cbcbcb"</span>),
        <span class="kw">panel.grid.major.y</span><span class="kw">=</span><span class="fu">element_blank</span>())</pre></body></html></div>
<pre><code>## Coordinate system already present. Adding new coordinate system, which will replace the existing one.</code></pre>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="no">bars</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div id="change-the-axis-text-manually" class="section level2">
<h2 class="hasAnchor">
<a href="#change-the-axis-text-manually" class="anchor"></a>Change the axis text manually</h2>
<p>You can change the axis text labels freely with <code>scale_y_continuous</code> or <code>scale_x_continuous</code>:</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="no">bars</span> <span class="kw">&lt;-</span> <span class="no">bars</span> + <span class="fu">scale_y_continuous</span>(<span class="kw">limits</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">85</span>),
                                  <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">80</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">20</span>),
                                  <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"0"</span>,<span class="st">"20"</span>, <span class="st">"40"</span>, <span class="st">"60"</span>, <span class="st">"80 years"</span>))</pre></body></html></div>
<pre><code>## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.</code></pre>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="no">bars</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>This will also specify the limits of your plot as well as where you want axis ticks.</p>
</div>
<div id="add-thousand-separators-to-your-axis-labels" class="section level2">
<h2 class="hasAnchor">
<a href="#add-thousand-separators-to-your-axis-labels" class="anchor"></a>Add thousand separators to your axis labels</h2>
<p>You can specify that you want your axis text to have thousand separators with an argument to <code>scale_y_continuous</code>.</p>
<p>There are two ways of doing this, one in base R which is a bit fiddly:</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r">+ <span class="fu">scale_y_continuous</span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="no">x</span>, <span class="kw">big.mark</span> <span class="kw">=</span> <span class="st">","</span>,
                                                 <span class="kw">scientific</span> <span class="kw">=</span> <span class="fl">FALSE</span>))</pre></body></html></div>
<p>The second way relies on the <code>scales</code> package, but is much more concise:</p>
<div class="sourceCode" id="cb49"><html><body><pre class="r">+ <span class="fu">scale_y_continuous</span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="no"><a href="https://scales.r-lib.org//reference/label_number.html">comma</a></span>)</pre></body></html></div>
</div>
<div id="add-percent-symbol-to-your-axis-labels" class="section level2">
<h2 class="hasAnchor">
<a href="#add-percent-symbol-to-your-axis-labels" class="anchor"></a>Add percent symbol to your axis labels</h2>
<p>This is also easy to add with an argument to <code>scale_y_continuous</code>:</p>
<div class="sourceCode" id="cb50"><html><body><pre class="r">+ <span class="fu">scale_y_continuous</span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">x</span>, <span class="st">"%"</span>))</pre></body></html></div>
</div>
<div id="change-the-plot-limits" class="section level2">
<h2 class="hasAnchor">
<a href="#change-the-plot-limits" class="anchor"></a>Change the plot limits</h2>
<p>The long way of setting the limits of your plot explicitly is with <code>scale_y_continuous</code> as above. But if you don’t need to specify the breaks or labels the shorthand way of doing it is with <code>xlim</code> or <code>ylim</code>:</p>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="no">bars</span> + <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">500</span>))</pre></body></html></div>
<pre><code>## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
<div id="add-axis-titles" class="section level2">
<h2 class="hasAnchor">
<a href="#add-axis-titles" class="anchor"></a>Add axis titles</h2>
<p>Our default theme has no axis titles, but you may wish to add them in manually. This is done by modifying <code>theme()</code>:</p>
<div class="sourceCode" id="cb53"><html><body><pre class="r">+ <span class="fu">theme</span>(<span class="kw">axis.title</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">18</span>))</pre></body></html></div>
</div>
<div id="modify-axis-titles" class="section level2">
<h2 class="hasAnchor">
<a href="#modify-axis-titles" class="anchor"></a>Modify axis titles</h2>
<p>If you add in axis titles, they will by default be the column names in your dataset. You can change this to anything you want in your call to <code>labs()</code>.</p>
<p>For instance, if you wish your x axis title to be “I’m an axis” and your y axis label to be blank, this would be the format:</p>
<div class="sourceCode" id="cb54"><html><body><pre class="r">+ <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"I'm an axis"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">""</span>)</pre></body></html></div>
</div>
<div id="add-axis-ticks" class="section level2">
<h2 class="hasAnchor">
<a href="#add-axis-ticks" class="anchor"></a>Add axis ticks</h2>
<p>You can add axis tick marks by adding <code>axis.ticks.x</code> or <code>axis.ticks.y</code> to your <code>theme</code>:</p>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">theme</span>(
  <span class="kw">axis.ticks.x</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#333333"</span>),
  <span class="kw">axis.ticks.length</span> <span class="kw">=</span>  <span class="fu">unit</span>(<span class="fl">0.26</span>, <span class="st">"cm"</span>))</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
</div>
<div id="add-annotations" class="section level1">
<h1 class="hasAnchor">
<a href="#add-annotations" class="anchor"></a>Add annotations</h1>
<div id="add-an-annotation" class="section level2">
<h2 class="hasAnchor">
<a href="#add-an-annotation" class="anchor"></a>Add an annotation</h2>
<p>The easiest way to add a text annotation to your plot is using <code>geom_label</code>:</p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1980</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"I'm an annotation!"</span>),
                           <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0</span>,
                           <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
                           <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#555555"</span>,
                           <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"white"</span>,
                           <span class="kw">label.size</span> <span class="kw">=</span> <span class="fl">NA</span>,
                           <span class="kw">family</span><span class="kw">=</span><span class="st">"Merriweather"</span>,
                           <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
<p>The exact positioning of the annotation will depend on the <code>x</code> and <code>y</code> arguments (which is a bit fiddly!) and the text alignment, using <code>hjust</code> and <code>vjust</code> - but more on that below.</p>
<p>Add line breaks where necessary in your label with <code>\n</code>, and set the line height with <code>lineheight</code>.</p>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="no">multiple_line</span> <span class="kw">&lt;-</span> <span class="no">multiple_line</span> +
  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1980</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"I'm quite a long\nannotation over\nthree rows"</span>),
             <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0</span>,
             <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
             <span class="kw">lineheight</span> <span class="kw">=</span> <span class="fl">0.8</span>,
             <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#555555"</span>,
             <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"white"</span>,
             <span class="kw">label.size</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">family</span><span class="kw">=</span><span class="st">"Merriweather"</span>,
             <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>)</pre></body></html></div>
<p>Let’s get our direct labels in there!</p>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="no">multiple_line</span> <span class="kw">&lt;-</span> <span class="no">multiple_line</span> +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1950</span>, <span class="fl">2011</span>)) +
  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">2007</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">79</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"US"</span>),
             <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0</span>,
             <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
             <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#1380A1"</span>,
             <span class="kw">fill</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">label.size</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>) +
  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">2007</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">72</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"China"</span>),
             <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0</span>,
             <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
             <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#FAAB18"</span>,
             <span class="kw">fill</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">label.size</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>)

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">multiple_line</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
</div>
<div id="left-alignright-align-text" class="section level2">
<h2 class="hasAnchor">
<a href="#left-alignright-align-text" class="anchor"></a>Left-align/right-align text</h2>
<p>The arguments <code>hjust</code> and <code>vjust</code> dictate horizontal and vertical text alignment. They can have a value between 0 and 1, where 0 is left-justified and 1 is right-justified (or bottom- and top-justified for vertical alignment).</p>
</div>
<div id="add-labels-based-on-your-data" class="section level2">
<h2 class="hasAnchor">
<a href="#add-labels-based-on-your-data" class="anchor"></a>Add labels based on your data</h2>
<p>The above method for adding annotations to your chart lets you specify the x and y coordinates exactly. This is very useful if we want to add a text annotation in a specific place, but would be very tedious to repeat.</p>
<p>Fortunately, if you want to add labels to all your data points, you can simply set the position based on your data instead.</p>
<p>Let’s say we want to add data labels to our bar chart:</p>
<div class="sourceCode" id="cb59"><html><body><pre class="r"><span class="no">labelled.bars</span> <span class="kw">&lt;-</span> <span class="no">bars</span> +
  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">country</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">lifeExp</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">lifeExp</span>, <span class="fl">0</span>)),
             <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">1</span>,
             <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
             <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"white"</span>,
             <span class="kw">fill</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">label.size</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">family</span><span class="kw">=</span><span class="st">"Merriweather"</span>,
             <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>)

<span class="no">labelled.bars</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>The above code automatically adds one text label for each continent, without us having to add <code>geom_label</code> five separate times.</p>
<p>(If you’re confused about why we’re setting the <code>x</code> as the continents and <code>y</code> as life expectancy, when the chart appears to be drawing them the other way around, it’s because we’ve flipped the coordinates of the plot using <code>coord_flip()</code>, which you can <a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">read more about here</a>.)</p>
</div>
<div id="add-left-aligned-labels-to-bar-charts" class="section level2">
<h2 class="hasAnchor">
<a href="#add-left-aligned-labels-to-bar-charts" class="anchor"></a>Add left-aligned labels to bar charts</h2>
<p>If you’d rather add left-aligned labels for your bars, just set the <code>x</code> argument based on your data, but specify the <code>y</code> argument directly instead, with a numeric value.</p>
<p>The exact value of <code>y</code> will depend on the range of your data.</p>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="no">labelled.bars.v2</span> <span class="kw">&lt;-</span> <span class="no">bars</span> +
  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">country</span>,
                 <span class="kw">y</span> <span class="kw">=</span> <span class="fl">4</span>,
                 <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">lifeExp</span>, <span class="fl">0</span>)),
             <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0</span>,
             <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
             <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"white"</span>,
             <span class="kw">fill</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">label.size</span> <span class="kw">=</span> <span class="fl">NA</span>,
             <span class="kw">family</span><span class="kw">=</span><span class="st">"Merriweather"</span>,
             <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>)

<span class="no">labelled.bars.v2</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
</div>
<div id="add-a-line" class="section level2">
<h2 class="hasAnchor">
<a href="#add-a-line" class="anchor"></a>Add a line</h2>
<p>Add a line with <code>geom_segment</code>:</p>
<div class="sourceCode" id="cb61"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1979</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">xend</span> <span class="kw">=</span> <span class="fl">1965</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="fl">43</span>),
                             <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#555555"</span>,
                             <span class="kw">size</span><span class="kw">=</span><span class="fl">0.5</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
<p>The <code>size</code> argument specifies the thickness of the line.</p>
</div>
<div id="add-a-curved-line" class="section level2">
<h2 class="hasAnchor">
<a href="#add-a-curved-line" class="anchor"></a>Add a curved line</h2>
<p>For a curved line, use <code>geom_curve</code> instead of <code>geom_segment</code>:</p>
<div class="sourceCode" id="cb62"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1979</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">xend</span> <span class="kw">=</span> <span class="fl">1965</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="fl">43</span>),
                           <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#555555"</span>,
                           <span class="kw">curvature</span> <span class="kw">=</span> -<span class="fl">0.2</span>,
                           <span class="kw">size</span><span class="kw">=</span><span class="fl">0.5</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
<p>The <code>curvature</code> argument sets the amount of curve: 0 is a straight line, negative values give a left-hand curve and positive values give a right-hand curve.</p>
</div>
<div id="add-an-arrow" class="section level2">
<h2 class="hasAnchor">
<a href="#add-an-arrow" class="anchor"></a>Add an arrow</h2>
<p>Turning a line into an arrow is fairly straightforward: just add the <code>arrow</code> argument to your <code>geom_segment</code> or <code>geom_curve</code>:</p>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1979</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">xend</span> <span class="kw">=</span> <span class="fl">1965</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="fl">43</span>),
                           <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#555555"</span>,
                           <span class="kw">size</span><span class="kw">=</span><span class="fl">0.5</span>,
                           <span class="kw">curvature</span> <span class="kw">=</span> -<span class="fl">0.2</span>,
                           <span class="kw">arrow</span> <span class="kw">=</span> <span class="fu">arrow</span>(<span class="kw">length</span> <span class="kw">=</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>)))</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-42-1.png" width="700"></p>
<p>The first argument to <code>unit</code> sets the size of the arrowhead.</p>
</div>
<div id="add-a-line-across-the-whole-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#add-a-line-across-the-whole-plot" class="anchor"></a>Add a line across the whole plot</h2>
<p>The easiest way to add a line across the whole plot is with <code>geom_vline()</code>, for a vertical line, or <code>geom_hline()</code>, for a horizontal one.</p>
<p>Optional additional arguments allow you to specify the size, colour and type of line (the default option is a solid one).</p>
<div class="sourceCode" id="cb64"><html><body><pre class="r"><span class="no">multiple_line</span> + <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<p>The line obviously doesn’t add much in this example, but this is useful if you want to highlight something, e.g. a threshold level, or an average value.</p>
<p>It’s also especially useful because our design style - as you may already have noticed from the charts on this page - is to add a vertical or horizontal baseline to our charts. This is the code to use:</p>
<div class="sourceCode" id="cb65"><html><body><pre class="r">+ <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#333333"</span>)</pre></body></html></div>
</div>
</div>
<div id="work-with-small-multiples" class="section level1">
<h1 class="hasAnchor">
<a href="#work-with-small-multiples" class="anchor"></a>Work with small multiples</h1>
<p>Small multiple charts are easy to create with ggplot: it’s called faceting.</p>
<div id="facets" class="section level2">
<h2 class="hasAnchor">
<a href="#facets" class="anchor"></a>Facets</h2>
<p>If you have data that you want to visualise split up by some variable, you need to use <code>facet_wrap</code> or <code>facet_grid</code>.</p>
<p>Add the variable you want to divide by to this line of code: <code>facet_wrap( ~ variable)</code>.</p>
<p>An additional argument to facet wrap, <code>ncol</code>, allows you to specify the number of columns:</p>
<div class="sourceCode" id="cb66"><html><body><pre class="r"><span class="co">#Prepare data</span>
<span class="no">facet</span> <span class="kw">&lt;-</span> <span class="no">gapminder</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">continent</span> <span class="kw">!=</span> <span class="st">"Americas"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">continent</span>, <span class="no">year</span>) <span class="kw">%&gt;%</span>
  <span class="fu">summarise</span>(<span class="kw">pop</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">pop</span>)))

<span class="co">#Make plot</span>
<span class="no">facet_plot</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>() +
  <span class="fu">geom_area</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">facet</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">year</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">pop</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">continent</span>)) +
  <span class="fu">facet_wrap</span>( ~ <span class="no">continent</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">5</span>) +
  <span class="fu">scale_y_continuous</span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">2000000000</span>, <span class="fl">4000000000</span>),
                     <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="st">"2bn"</span>, <span class="st">"4bn"</span>)) +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>,
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>()) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Asia's rapid growth"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Population growth by continent, 1952-2007"</span>)

<span class="no">facet_plot</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-45-1.png" width="700"></p>
</div>
<div id="free-scales" class="section level2">
<h2 class="hasAnchor">
<a href="#free-scales" class="anchor"></a>Free scales</h2>
<p>You may have noticed in the chart above that Oceania, with its relatively small population, has disappeared completely.</p>
<p>By default, faceting uses fixed axis scales across the small multiples. It’s always best to use the same y axis scale across small multiples, to avoid misleading, but sometimes you may need to set these independently for each multiple, which we can do by adding the argument <code>scales = "free"</code>.</p>
<p>If you just want to free the scales for one axis set the argument to <code>free_x</code> or <code>free_y</code>.</p>
<div class="sourceCode" id="cb67"><html><body><pre class="r"><span class="co">#Make plot</span>
<span class="no">facet_plot_free</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>() +
  <span class="fu">geom_area</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">facet</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">year</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">pop</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">continent</span>)) +
  <span class="fu">facet_wrap</span>(~ <span class="no">continent</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>) +
  <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#333333"</span>) +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>,
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu">element_blank</span>()) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"It's all relative"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Relative population growth by continent,1952-2007"</span>)

<span class="no">facet_plot_free</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-46-1.png" width="700"></p>
</div>
</div>
<div id="do-something-else-entirely" class="section level1">
<h1 class="hasAnchor">
<a href="#do-something-else-entirely" class="anchor"></a>Do something else entirely</h1>
<div id="increase-or-decrease-margins" class="section level2">
<h2 class="hasAnchor">
<a href="#increase-or-decrease-margins" class="anchor"></a>Increase or decrease margins</h2>
<p>You can change the margin around almost any element of your plot - the title, subtitles, legend - or the plot itself.</p>
<p>You shouldn’t ordinarily need to change the default margins from the theme but if you do, the syntax is <code>theme(ELEMENT=element_text(margin=margin(0, 5, 10, 0)))</code>.</p>
<p>The numbers specify the top, right, bottom, and left margin respectively - but you can also specify directly which margin you want to change. For example, let’s try giving the subtitle an extra-large bottom margin:</p>
<div class="sourceCode" id="cb68"><html><body><pre class="r"><span class="no">bars</span> + <span class="fu">theme</span>(<span class="kw">plot.subtitle</span><span class="kw">=</span><span class="fu">element_text</span>(<span class="kw">margin</span><span class="kw">=</span><span class="fu">margin</span>(<span class="kw">b</span><span class="kw">=</span><span class="fl">75</span>)))</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-47-1.png" width="700"></p>
<p>Hm… maybe not.</p>
</div>
<div id="exporting-your-plot-and-x-axis-margins" class="section level2">
<h2 class="hasAnchor">
<a href="#exporting-your-plot-and-x-axis-margins" class="anchor"></a>Exporting your plot and x-axis margins</h2>
<p>You do need to think about your x-axis margin sizes when you are producing a plot that is beyond the default height in <code>bbplot</code>, which is 450px. This could be the case for example if you are creating a bar chart with lots of bars and want to make sure there is some breathing space between each bar and labels. If you do leave the margins as they are for plots with a greater height, then you could get a larger gap between the axis and your labels.</p>
<p>Here is a guide that we work to when it comes to the margins and the height of your bar chart (with coord_flip applied to it):</p>
<table class="table">
<thead><tr class="header">
<th align="left">size</th>
<th align="right">t</th>
<th align="right">b</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">550px</td>
<td align="right">5</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">650px</td>
<td align="right">7</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">750px</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">850px</td>
<td align="right">14</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>So what you’d need to do is add this code to your chart if for example you wanted the height of your plot to be 650px instead of 450px.</p>
<div class="sourceCode" id="cb69"><html><body><pre class="r"><span class="no">bar_chart_tall</span> <span class="kw">&lt;-</span> <span class="no">bars</span> + <span class="fu">theme</span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">margin</span><span class="kw">=</span><span class="fu">margin</span>(<span class="kw">t</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">b</span> <span class="kw">=</span> <span class="fl">10</span>)))
<span class="no">bar_chart_tall</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-48-1.png" width="700"></p>
<p>Although it is much less likely, but if you do want to do the equivalent for a line chart and export it at a larger than default height, you need to do the same but change your values for t to negative values based on the table above.</p>
</div>
<div id="reorder-bars-by-size" class="section level2">
<h2 class="hasAnchor">
<a href="#reorder-bars-by-size" class="anchor"></a>Reorder bars by size</h2>
<p>By default, R will display your data in alphabetical order, but arranging it by size instead is simple: just wrap <code><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder()</a></code> around the <code>x</code> or <code>y</code> variable you want to rearrange, and specify which variable you want to reorder it by.</p>
<p>E.g. <code>x = reorder(country, pop)</code>. Ascending order is the default, but you can change it to descending by wrapping <code>desc()</code> around the variable you’re ordering by:</p>
<div class="sourceCode" id="cb70"><html><body><pre class="r"><span class="no">bars</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">bar_df</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">country</span>, <span class="no">lifeExp</span>), <span class="kw">y</span> <span class="kw">=</span> <span class="no">lifeExp</span>)) +
  <span class="fu">geom_bar</span>(<span class="kw">stat</span><span class="kw">=</span><span class="st">"identity"</span>, <span class="kw">position</span><span class="kw">=</span><span class="st">"identity"</span>) +
  <span class="fu">coord_flip</span>() +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"Reunion is highest"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Highest African life expectancy, 2007"</span>) +
  <span class="fu">theme</span>(<span class="kw">panel.grid.major.x</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"#cbcbcb"</span>),
        <span class="kw">panel.grid.major.y</span><span class="kw">=</span><span class="fu">element_blank</span>())

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">bars</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-49-1.png" width="700"></p>
</div>
<div id="reorder-bars-manually" class="section level2">
<h2 class="hasAnchor">
<a href="#reorder-bars-manually" class="anchor"></a>Reorder bars manually</h2>
<p>Sometimes you need to order your data in a way that isn’t alphabetical or reordered by size.</p>
<p>To order these correctly you need to set your data’s factor levels before making the plot.</p>
<p>Specify the order you want the categories to be plotted in the <code>levels</code> argument:</p>
<div class="sourceCode" id="cb71"><html><body><pre class="r"><span class="no">dataset</span>$<span class="no">column</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">dataset</span>$<span class="no">column</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"18-24"</span>,<span class="st">"25-64"</span>,<span class="st">"65+"</span>))</pre></body></html></div>
<p>You can also use this to reorder the stacks of a stacked bar chart.</p>
</div>
<div id="colour-bars-conditionally" class="section level2">
<h2 class="hasAnchor">
<a href="#colour-bars-conditionally" class="anchor"></a>Colour bars conditionally</h2>
<p>You can set aesthetic values like fill, alpha, size conditionally with <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>.</p>
<p>The syntax is <code>fill=ifelse(logical_condition, fill_if_true, fill_if_false)</code>.</p>
<div class="sourceCode" id="cb72"><html><body><pre class="r"><span class="fu">ggplot</span>(<span class="no">bar_df</span>,
       <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">country</span>, <span class="no">lifeExp</span>), <span class="kw">y</span> <span class="kw">=</span> <span class="no">lifeExp</span>)) +
  <span class="fu">geom_bar</span>(<span class="kw">stat</span><span class="kw">=</span><span class="st">"identity"</span>, <span class="kw">position</span><span class="kw">=</span><span class="st">"identity"</span>, <span class="kw">fill</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">bar_df</span>$<span class="no">country</span> <span class="kw">==</span> <span class="st">"Mauritius"</span>, <span class="st">"#1380A1"</span>, <span class="st">"#dddddd"</span>)) +
  <span class="fu">coord_flip</span>() +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"Reunion is highest"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Highest African life expectancy, 2007"</span>) +
  <span class="fu">theme</span>(<span class="kw">panel.grid.major.x</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"#cbcbcb"</span>),
        <span class="kw">panel.grid.major.y</span><span class="kw">=</span><span class="fu">element_blank</span>())</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael Harper.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
